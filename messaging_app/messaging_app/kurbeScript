#!/bin/bash

# 0. Clean up any previous cluster (important when changing drivers)
echo "Deleting any existing Minikube cluster..."
minikube delete

# 1. Start a Kubernetes cluster using the reliable VirtualBox driver
echo "Starting Minikube cluster with the VirtualBox driver..."
# The --memory and --cpus flags give the cluster enough resources from your 8GB RAM
 minikube start --driver=virtualbox --memory 4096 --cpus 2

if [ $? -ne 0 ]; then
    echo "ERROR: Minikube failed to start. Review VirtualBox installation."
    exit 1
fi

echo "--------------------------------------------------------"

# 2. Verify the cluster is running
echo "Verifying cluster status..."
kubectl cluster-info

echo "--------------------------------------------------------"

# 3. Retrieve the available pods (system pods)
echo "Retrieving available pods..."
kubectl get pods --all-namespaces

echo "Task 0 Complete. Minikube cluster is ready."
